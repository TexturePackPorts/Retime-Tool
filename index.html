<!DOCTYPE html>
<html>
<head>
    <title>Speedrun Retime Tool</title>
    <meta content="Retime Tool" property="og:title" />
    <meta content="An easy to use Retime Tool for Speedruns" property="og:description" />
    <meta content="https://embed.com/this-is-the-site-url" property="og:url" />
    <meta content="https://embed.com/embedimage.png" property="og:image" />
    <meta content="#333" data-react-helmet="true" name="theme-color" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link rel="icon" type="image/x-icon" href="favicon.png">
    <link rel="stylesheet" href="style.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
    <h1>Speedrun Retime Tool</h1>
    <h2>Made by hxmbt</h2>
    <form id="timeForm">
        <label for="startTime">Start Time:</label><br>
        <textarea id="startTime" name="startTime"></textarea><br>
        <label for="endTime">End Time:</label><br>
        <textarea id="endTime" name="endTime"></textarea><br>
        <label for="fps">Video FPS:</label><br>
        <input type="text" id="fps" name="fps"><br>
        <input type="button" value="Calculate" onclick="calculateTime()">
        <button id="modeSwitcher">Switch to Dark Mode</button>
        <button id="copyButton">Copy Mod Note</button>
        <a href="https://www.youtube.com/@hxmbt2" id="youtube-button" target="_blank">
            <i class="fab fa-youtube"></i>
        </a>
    </form>
    <form id="addTimeForm">
        <label for="addTimeInput">Time to Add: </label><br>
        <input type="text" id="addTimeInput" name="addTimeInput"><br>
        <input type="button" value="Add Time" onclick="addTime()">
    </form>
    <p id="totalTime">Total Time: 0 seconds</p>
    <p id="result"></p>
    <p id="modMessage"></p>

    <script>
        function calculateTime() {
            var startTime = document.getElementById('startTime').value;
            var endTime = document.getElementById('endTime').value;
            var fps = document.getElementById('fps').value;

            if (isNaN(startTime) || isNaN(endTime) || isNaN(fps)) {
                document.getElementById('result').innerHTML = "Invalid input";
            } else {
                var differenceInFrames = (endTime - startTime) * fps;
                var differenceInSeconds = differenceInFrames / fps;
                document.getElementById('result').innerHTML = "Total frames: " + Math.round(differenceInFrames) + ", Total time: " + differenceInSeconds.toFixed(3) + " seconds";

                var startFrame = Math.round(startTime * fps);
                var endFrame = Math.round(endTime * fps);
                var consoleTime = differenceInSeconds.toFixed(3);
                var videoFps = fps;
                document.getElementById('modMessage').innerHTML = "Mod Note: Start Frame (" + startFrame + "), End Frame: (" + endFrame + "), FPS: (" + videoFps + "), Time: (" + consoleTime + ")";
            }
        }

        function extractTime(debugInfo) {
            var debugJson = JSON.parse(debugInfo);
            return parseFloat(debugJson.vct);
        }

        document.getElementById('modeSwitcher').addEventListener('click', function(event) {
            event.preventDefault()
            var body = document.body;
            if (body.classList.contains('dark-mode')) {
                body.classList.remove('dark-mode');
                this.innerHTML = "Switch to Dark Mode"
            } else {
                body.classList.add('dark-mode');
                this.innerHTML = "Switch to Light Mode";
            }
        })

        document.getElementById('startTime').addEventListener('blur', function() {
            this.value = extractTime(this.value)
        });

        document.getElementById('endTime').addEventListener('blur', function() {
            this.value = extractTime(this.value)
        });

        document.getElementById('copyButton').addEventListener('click', function(event) {
            event.preventDefault()
            var modMessage = document.getElementById('modMessage').innerHTML;

            navigator.clipboard.writeText(modMessage)
            this.innerHTML = "Copied!";
            var button = this;

            setTimeout(function() {
                button.innerHTML = "Copy Mod Note";
            }, 2000);
        });

        var totalTime = 0;

        function addTime() {
            var addTimeInput = document.getElementById('addTimeInput').value;
            var addTimeInSeconds = parseFloat(addTimeInput);

            if (!isNaN(addTimeInSeconds)) {
                totalTime += addTimeInSeconds;
                document.getElementById('totalTime').innerHTML = "Total Time: " + totalTime.toFixed(3) + " seconds";
            } else {
                document.getElementById('totalTime').innerHTML = "Invalid input. Please enter a number.";
            }
        }
    </script>
</body>
</html>
